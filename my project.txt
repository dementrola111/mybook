CREATE DATABASE BlogBooks;
USE BlogBooks;

CREATE TABLE authors (
			 id INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
			 firstName NCHAR(40) NOT NULL,
			 lastName NCHAR(40) NOT NULL,
			 patronymic NCHAR(40),
			 foto NVARCHAR(150),
			 dataBirth DATE NOT NULL,
			 biography NVARCHAR(MAX) NOT NULL
)

CREATE TABLE kinds(
			id INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
			name NCHAR (40) NOT NULL
)

CREATE TABLE categories(
			id INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
			name NCHAR(40) NOT NULL,
			description NVARCHAR(1000) NOT NULL,
)

CREATE TABLE role(
			id INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
			rang NCHAR(30) NOT NULL
)

CREATE TABLE books(
			id INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
			name NCHAR(40) NOT NULL,
			id_author INT NOT NULL FOREIGN KEY REFERENCES authors(id) ON DELETE NO ACTION,
			photo NCHAR(100) NOT NULL,
			id_kind INT NOT NULL FOREIGN KEY REFERENCES kinds(id) ON DELETE NO ACTION
)

CREATE TABLE users(
			id INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
			login NCHAR(30) NOT NULL UNIQUE,
			password NCHAR(50) NOT NULL,
			id_role INT NOT NULL FOREIGN KEY REFERENCES role(id) ON DELETE NO ACTION,
			email NCHAR(50) NOT NULL  UNIQUE,
			date_registration DATE NOT NULL,
			date_birth DATE NOT NULL
)


CREATE TABLE articles(
			id INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
			title NCHAR(50) NOT NULL,
			annotation NVARCHAR(MAX) NOT NULL,
			text NVARCHAR(MAX) NOT NULL,
			date DATE NOT NULL,
			id_user INT NOT NULL FOREIGN KEY REFERENCES users(id) ON DELETE NO ACTION,
			publication BIT NOT NULL DEFAULT 0,
			keywords NCHAR(250) NOT NULL
)

CREATE TABLE category_article(
			id INT NOT NULL PRIMARY KEY IDENTITY(1,1),
			id_category INT NOT NULL FOREIGN KEY REFERENCES categories(id) ON DELETE NO ACTION,
			id_article INT NOT NULL FOREIGN KEY REFERENCES articles(id) ON DELETE CASCADE
)

CREATE TABLE fotos_article(
			id INT NOT NULL PRIMARY KEY IDENTITY(1,1),
			url NCHAR(150) NOT NULL,
			id_article INT NOT NULL FOREIGN KEY REFERENCES articles(id) ON DELETE CASCADE,
			alt NCHAR(250) NOT NULL				 
)

CREATE TABLE comments(
			id INT NOT NULL PRIMARY KEY IDENTITY(1,1),
			id_user INT NOT NULL FOREIGN KEY REFERENCES users(id) ON DELETE CASCADE,
			id_article INT NOT NULL FOREIGN KEY REFERENCES articles(id) ON DELETE CASCADE,
			text NVARCHAR(MAX) NOT NULL,
			date DATE NOT NULL,
			publication BIT NOT NULL DEFAULT 0,
)


set language us_english

SET DATEFORMAT ymd

select *
from authors


INSERT INTO authors(firstName, lastName, patronymic, dataBirth, biography)
     VALUES ('Неизвестно','Неизвестна','Неизвестно','1900-1-2','Нет автора. Нет биографии'),
            ('Джулия','Дональдсон','Нет','1946-09-16','Родилась в Лондоне в 1948 году. По словам Джулии, свой первый рассказ о кролике она написала в 5 лет. После окончания Бристольского университета Джулия работала на BBC, писала тексты песен для детских телепрограмм. В 1993 году она выпустила свою первую книжку с иллюстрациями Алекса Шеффлера, и с этих пор писательница и художник постоянно работают вместе. Всего Джулия Дональдсон написала около 80 произведений, 67 из которых опубликованы. Ее книги — это детская проза и поэзия, пьесы для детей и учебная литература. Сейчас Джулия живет в Шотландии (Глазго). Замужем, растит троих сыновей. В свободное время любит петь и играть на фортепиано.')
			('Александр','Пушкин','Сергеевич','1799-6-6','Алекса?ндр Серге?евич Пу?шкин — русский поэт, драматург и прозаик, заложивший основы русского реалистического направления, критик и теоретик литературы, историк, публицист; один из самых авторитетных литературных деятелей первой трети XIX века.'),
			('Джоан','Роулинг','K.','1965-7-31','Джоан Роулинг, известная под псевдонимами Дж. К. Роулинг (J. K. Rowling) и Роберт Гэлбрейт (Robert Galbraith), — британская писательница, сценаристка и кинопродюсер, наиболее известная как автор серии романов о Гарри Поттере. Книги о Гарри Поттере получили несколько наград и были проданы в количестве более 500 миллионов экземпляров. Они стали самой продаваемой серией книг в истории и основой для серии фильмов, ставшей третьей по кассовому сбору серией фильмов в истории. Джоан Роулинг сама утверждала сценарии фильмов, а также вошла в состав продюсеров последних двух частей.'),
			('Дэн','Браун',' ','1964-7-24','Дэн Бра?ун — американский писатель, журналист, музыкант. Из-под его пера вышли такие бестселлеры, как «Ангелы и демоны», «Код да Винчи», «Утраченный символ» и «Инферно», рассказывающие о тайных обществах, символике, заговорах. Его первый роман «Цифровая крепость» посвящён деятельности Агентства национальной безопасности США.')

select *
from categories
INSERT INTO categories(name, description)
      VALUES ('Книги детям','Посты о книгах для детей'),
			('Научная литература','Документальная литература и публицистика'),
			('Энциклопедии','Обзор энциклопедий для взрослых и детей'),
			('Коллекционные книги','Здесь можно почитать о коллекционных изданиях известной литературы'),
			('Здоровый нации','Данный раздел посвящен здоровому образу жизни. Здесь публикуются посты о спорте и здоровом питании'),
			('Художественная литература','Раздел посвященный художественной литературе')

INSERT INTO kinds(name)
     VALUES ('Художественная литература'),
	        ('Детская литература'),
			('Образование'),
			('Популярная психология'),
			('Деловая литература'),
			('Наука'),
			('Публицистика'),
			('Подарочные издания'),
			('Компьютеры и Интернет'),
			('Искусство. Культура'),
            ('Энциклопедии. Справочники'),
			('Аудиокниги')

INSERT INTO role(rang)
     VALUES ('administrator'),
			('user')

INSERT INTO users(login, password, id_role, email, date_registration, date_birth)
     VALUES ('Admin','12345',1,'dementrola@gmail.com','2019-05-17','1987-11-22'),
			('User','123',2,'dementrola@mail.ru','2019-05-17','1999-10-20')


select *
from authors
select *
from kinds
	        
INSERT INTO books(name, id_author, photo, id_kind)
VALUES	('Происхождение',6,'img-gorod.ru/web/262/2622044/jpg/2622044_detail.jpg',1),
		('Ангелы и демоны',6,'images.ua.prom.st/601703038_w640_h640_den-braun-angely.jpg',1),
		('Груффало',3,'mudry-filin.com.ua/wa-data/public/shop/products/77/08/877/images/15842/15842.745.jpg',2)


INSERT INTO articles (title,annotation,text, date, id_user, publication, keywords)
     VALUES  ('Алгоритм управления эмоциями','Эмоциональная сфера часто кажется нам хаотичной и непредсказуемой, поэтому для развития эмоционального интеллекта хорошо помогают структурированные схемы и алгоритмы. Одна из таких схем — это алгоритм управления эмоциями.','Эмоциональная сфера часто кажется нам хаотичной и не-предсказуемой, поэтому для развития эмоционального интеллекта хорошо помогают структурированные схемы и алгоритмы. Одна из таких схем — это алгоритм управления эмоциями. Он состоит из шести этапов, и в этой статье мы подробно рассмотрим каждый из них. 1. Осознать эмоцию./n Нам часто кажется, что основная причина того, что мы не справляемся со своими эмоциями в каких-то ситуациях — это то, что мы не знаем каких-то способов управления. Но на самом деле, ключевая сложность кроется в том, что мы не успеваем вовремя осознать свою эмоцию и понять, что с ней нужно что-то сделать. В культуре, в которой мы росли, эмоции считались признаком слабости, и их необходимо было как можно быстрее научиться подавлять. Почти каждый неоднократно слышал в детстве: Держи себя в руках!, Не реви!, Не смей злиться на взрослых!, Обижаться глупо, Боятся только трусы, Смех без причины — признак дурачины. В большинстве семей не было принято интересоваться эмоциональным состоянием ребенка (вспомните, как часто вас спрашивали с искренним интересом: Что ты чувствуешь?. Считалось, что эмоции мешают успешности и нормальному функционированию в социуме. Эмоциональность детей часто высмеивалась. Благодаря этому большинство современных взрослых хорошо научились свои эмоции прятать, скрывать и подавлять, но никак не осознавать. Во многом поэтому часто путают управление эмоциями и контроль. Контроль — про сдерживание, про держать лицо. Управление эмоциями — про то, как использовать эмоции себе на благо, использовать их энергию для достижения моих целей. А для этого эмоции важно прежде всего осознавать. Делать это сложно не только потому, что нас никогда этому не учили, но и из-за некоторых объективных сложностей, которые мы назвали Глобальной драмой эмоционального интеллекта. Для того, чтобы осознать эмоцию, нам нужно быть в состоянии нормально думать и назвать эмоцию словом. Для называния эмоций низкой интенсивности в языке не хватает слов, а когда мы испытываем сильные эмоции, мы теряем способность нормально думать. Таким образом, осознать эмоцию в моменте очень сложно, и прежде всего мы рекомендуем тренировать именно этот навык.','2019-3-14',3,1,'МИФ, Манн Иванов и Фербер, лучшая книга, топ книг, саморазвитие, бизнес литература'),
	    	('Даже потянуло перечитать','Пока с произведениями Дэна Брауна я знакома только через экранизации. Но сразу скажу, что фильм Ангелы и демоны сильно отличается от оригинальной книги. Да, фильм очень эпичный, но расхождения с книгой производят не очень хорошие впечатления.','Пока с произведениями Дэна Брауна я знакома только через экранизации. Но сразу скажу, что фильм Ангелы и демоны сильно отличается от оригинальной книги. Да, фильм очень эпичный, но расхождения с книгой производят не очень хорошие впечатления. Итак, давно забытое братство Иллюмината решило напомнить о себе через довольно странные обстоятельства. Убит известный физик Леонардо Ветра, который умудрялся совмещать научные открытия с верой в Бога, что стало причиной его ужасной смерти. Профессор Роберт Лэнгдон из Гарварда, приглашённый для изучения символа, выжженного на теле убитого, мастерски разгадывает загадки. Ему помогает Виттория Ветра, приёмная дочь Леонардо. Вместе с Лэнгдоном она находит путь просвещения, используя стихотворение, написанное на одной из страниц известного труда Галилея, и скульптуры Бернини, расположенные в нескольких церквях по всему Риму. Дэн Браун достаточно умело описывает все события. История просто завораживает, даже зная, что это вымысел, легко можно прочувствовать ту атмосферу. В дальнейшем я планирую прочитать продолжение этой серии.','2018-5-3',3,1,'Детектив, Современная литература, Дэн браун, Приключения, Религия, Зарубежная литература, Мистика, Загадки, Браун, Американская литература' ),
			('O постаревших Дэне и Роберте','Честно говоря, совершенно не собирался читать последнюю книгу Брауна, у меня заранее появилось безразличное отношение к роману, мое отношение стало результатом убежденности в том, что автор не удивит меня чем-то новым, потому что я читал более ранние романы автора и более или менее знал, чего ожидать. Но три небольших обстоятельства развернули меня буквально на 180 градусов: мой коллега по чтению tortila посчитал Роман достойным, в игре Пятилетку - в три тома мне выпал Цикл о Лэнгдоне, роман начитал мой любимый чтец Александр Владимирович Клюквин.','Честно говоря, совершенно не собирался читать последнюю книгу Брауна, у меня заранее появилось безразличное отношение к роману, мое отношение стало результатом убежденности в том, что автор не удивит меня чем-то новым, потому что я читал более ранние романы автора и более или менее знал, чего ожидать. Но три небольших обстоятельства развернули меня буквально на 180 градусов: мой коллега по чтению tortila посчитал Роман достойным, в игре ПЯТИЛЕТКУ В ТРИ ТОМА мне выпал Цикл о Лэнгдоне, роман начитал мой любимый чтец Александр Владимирович Клюквин. Действительно, мои опасения подтвердились, роман напоминал предыдущее повествование. Тут вам не головокружительные изъяснения, принуждающие лезть после каждого абзаца в Википедию. Да, автор использует те же схемы, нет недостатка в быстрых действиях, погонях, интригах, заговорах и головоломках, но я это уже знаю, поэтому данной историей автор не смог меня удивить, похоже не только старина Роберт постарел, постарел ещё и творец-Дэн. Хотя роман предсказуем для поклонников Дэна Брауна, он будет отличным чтением, и его стоит посвятить своему времени, хотя бы для того, чтобы сравнить его ценность с предыдущими книгами автора. Сильной стороной книги являются описания Барселоны и ее памятников, которые автор сделал с необычной точностью, описывая их дотошно, надежно, красиво и красочно. И я с большим интересом читаю эти фрагменты, потому что они заполнили пробел в моем образовании, потому что я никогда не был в Барселоне, и это, несомненно, необычный город, и стоит узнать о его достопримечательностях и истории. До этого романа были только в голове описания Сафоновский Барселоны, теперь она перезагрузилась брауновскими элементами, понравилось то, что местом действия была выбрана именно Испания И все же получилось -2 балла, так как автор не смог заинтересовать так сильно, как могут некоторые современные футурологи, эта литературная выдумка разочаровала больше, чем головоломки прошлых книг, и вы можете почувствовать неудовлетворенность и разочарование, и будете правы. "Интеллектуальности" в романе стало меньше, потому многие честно скажут, что Происхождение - самый слабый Роман автора, может, я соглашусь с таким мнением. И все же я прибавил балл, благодаря золотому голосу Александра Клюквина, честно словил себя на мысли, очень понравилась именно начиткa. Подводя итог книге, понимаю, что читать легко, приятно, но это было не так волнующе, потому что некоторые проблемы могли быть предсказаны заранее, финальная часть разочаровала, поэтому мой рейтинг не может быть выше.','2019-4-16',3,1,'Выбор читателей 2018, Американская литература, Детектив, Религия, Роберт лэнгдон, Современная литература, Испания, Искусство, Триллер, Дэн браун, Браун')


INSERT INTO category_article (id_category,id_article)
     VALUES (6,7),
			(6,8),
			(2,12),
			(7,12),
			(5,12),
			(1,13),
			(2,14),
			(7,14)			